<!DOCTYPE html>
<html>
<head>
    <title>Inventory Management System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        h1 {
            color: #343a40;
            text-align: center;
            margin-bottom: 40px;
        }
        .container {
            flex: 1;
            max-width: 1000px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .section {
            margin-bottom: 20px;
        }
        h2 {
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .form-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        .form-group input {
            flex: 1 1 calc(33% - 10px);
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
        }
        .form-group button {
            padding: 15px 30px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 200px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s, transform 0.1s;
        }
        .form-group button:hover {
            background-color: #0056b3;
        }
        .form-group button:active {
            transform: scale(0.95);
        }
        ul {
            list-style: none;
            padding: 0;
        }
        li {
            background: #e9ecef;
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .footer {
            text-align: center;
            padding: 10px;
            background-color: #f1f1f1;
            border-top: 1px solid #ddd;
            width: 100%;
            margin-top: auto;
        }
        .footer .disclaimer {
            color: #856404;
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ffeeba;
            display: inline-block;
        }
    </style>
</head>
<body>
<h1 id="title">Inventory Management System</h1>
<div class="container">
    <div class="section">
        <h2>Add Product</h2>
        <div class="form-group">
            <input type="text" id="name" placeholder="Name">
            <input type="number" id="quantity" placeholder="Quantity">
            <input type="number" step="0.01" id="price" placeholder="Price">
        </div>
        <div class="form-group">
            <button onclick="addProduct()">Add Product</button>
        </div>
    </div>
    <div class="section">
        <h2>Update Product</h2>
        <div class="form-group">
            <input type="number" id="updateId" placeholder="Product ID">
            <input type="text" id="updateName" placeholder="Name">
            <input type="number" id="updateQuantity" placeholder="Quantity">
            <input type="number" step="0.01" id="updatePrice" placeholder="Price">
        </div>
        <div class="form-group">
            <button onclick="updateProduct()">Update Product</button>
        </div>
    </div>
    <div class="section">
        <h2>Delete Product</h2>
        <div class="form-group">
            <input type="number" id="deleteId" placeholder="Product ID">
        </div>
        <div class="form-group">
            <button onclick="deleteProduct()">Delete Product</button>
        </div>
    </div>
    <div class="section">
        <h2>All Products</h2>
        <div class="form-group">
            <button onclick="getAllProducts()">Get All Products</button>
        </div>
        <ul id="productList"></ul>
    </div>
</div>
<div class="footer">
    <div class="disclaimer">
        <strong>Disclaimer:</strong> For workshop use only. Not for production.
    </div>
</div>
<script>
    let apiBaseUrl = 'http://localhost:8080/api/products'; // Default for local development
    let version = '1.0.0';

    // Try to fetch the config.json file
    fetch('config.json')
        .then(response => {
            if (!response.ok) {
                // If config.json is not found, fallback to default apiBaseUrl
                throw new Error('Config file not found');
            }
            return response.json();
        })
        .then(config => {
            apiBaseUrl = config.apiBaseUrl;
            version = config.version;
            document.getElementById('title').innerText = `Inventory Management System v${version}`;
        })
        .catch(error => {
            console.warn('Using default API base URL:', apiBaseUrl);
            document.getElementById('title').innerText = `Inventory Management System v${version}`;
        });

    window.addProduct = function() {
        const name = document.getElementById('name').value;
        const quantity = document.getElementById('quantity').value;
        const price = document.getElementById('price').value;

        fetch(apiBaseUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ name, quantity, price })
        })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    throw new Error(data.error);
                }
                alert('Product added successfully');
                getAllProducts();
            })
            .catch(error => {
                alert('Error: ' + error.message);
            });
    }

    window.updateProduct = function() {
        const id = document.getElementById('updateId').value;
        const name = document.getElementById('updateName').value;
        const quantity = document.getElementById('updateQuantity').value;
        const price = document.getElementById('updatePrice').value;

        fetch(`${apiBaseUrl}/${id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ name, quantity, price })
        })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    throw new Error(data.error);
                }
                alert('Product updated successfully');
                getAllProducts();
            })
            .catch(error => {
                alert('Error: ' + error.message);
            });
    }

    window.deleteProduct = function() {
        const id = document.getElementById('deleteId').value;

        fetch(`${apiBaseUrl}/${id}`, {
            method: 'DELETE'
        })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(err => { throw new Error(err.message); });
                }
                alert('Product deleted successfully');
                getAllProducts();
            })
            .catch(error => {
                alert('Error: ' + error.message);
            });
    }

    window.getAllProducts = function() {
        fetch(apiBaseUrl)
            .then(response => response.json())
            .then(data => {
                const productList = document.getElementById('productList');
                productList.innerHTML = '';
                data.forEach(product => {
                    const li = document.createElement('li');
                    li.textContent = `ID: ${product.id}, Name: ${product.name}, Quantity: ${product.quantity}, Price: ${product.price}`;
                    productList.appendChild(li);
                });
            })
            .catch(error => {
                alert('Error: ' + error.message);
            });
    }
</script>
</body>
</html>
